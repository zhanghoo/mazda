(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c2eb"],{2599:function(n,i,e){var t=e("d219");"string"===typeof t&&(t=[[n.i,t,""]]),t.locals&&(n.exports=t.locals);var o=e("499e").default;o("5d34bf54",t,!0,{sourceMap:!1,shadowMode:!1})},"2f21":function(n,i,e){"use strict";var t=e("79e5");n.exports=function(n,i){return!!n&&t(function(){i?n.call(null,function(){},1):n.call(null)})}},"55dd":function(n,i,e){"use strict";var t=e("5ca1"),o=e("d8e8"),r=e("4bf8"),a=e("79e5"),c=[].sort,s=[1,2,3];t(t.P+t.F*(a(function(){s.sort(void 0)})||!a(function(){s.sort(null)})||!e("2f21")(c)),"Array",{sort:function(n){return void 0===n?c.call(r(this)):c.call(r(this),o(n))}})},"87ce":function(n,i,e){n.exports=e.p+"img/mazidalogo.ffe50011.png"},a2de:function(n,i,e){"use strict";var t=e("2599"),o=e.n(t);o.a},ac89:function(n,i,e){n.exports=e.p+"img/index_title_bg.5bff82f8.png"},d219:function(n,i,e){var t=e("b041");i=n.exports=e("2350")(!1),i.push([n.i,"\n@media screen and (min-width:981px){\n#client{align-items:center;min-height:100vh\n}\n#client,#client .index-container{display:flex;position:relative;width:100%\n}\n#client .index-container{background:#fff;border-radius:4px;height:4.931rem;margin:0 auto;max-width:980px;overflow:hidden\n}\n#client .index-container .index-menu{background:#0d0d0e;height:100%;padding-top:.348rem;position:relative;width:.612rem\n}\n#client .index-container .index-menu .menu-user{align-items:center;display:flex;flex-direction:column;justify-content:center;margin:10px 0 50px;padding-top:10px\n}\n#client .index-container .index-menu .menu-user .user-avatar{cursor:pointer;display:block;height:44px;width:44px\n}\n#client .index-container .index-menu .menu-user .user-status{color:#fff;font-size:12px;margin:10px 0\n}\n#client .index-container .index-menu .menu-tabs .tabs-item{align-items:center;color:#fff;cursor:pointer;display:flex;font-size:24px;height:46px;justify-content:center;margin-bottom:15px\n}\n#client .index-container .index-menu .menu-tabs .tabs-item.active,#client .index-container .index-menu .menu-tabs .tabs-item:hover{background:#ce1b10\n}\n#client .index-container .index-menu .menu-tabs .tabs-item .item-label{display:none\n}\n#client .index-container .index-menu .menu-setting{bottom:48px;cursor:pointer;height:46px;position:absolute;width:100%\n}\n#client .index-container .index-menu .menu-setting:hover{background:#ce1b10\n}\n#client .index-container .index-menu .menu-setting .setting-icon{align-items:center;color:#fff;display:flex;font-size:20px;height:100%;justify-content:center;width:100%\n}\n#client .index-container .index-right{flex:1;height:100%;overflow:hidden;position:relative\n}\n#client .index-container .index-right .index-title{align-items:center;background:url("+t(e("ac89"))+") no-repeat 0;background-size:100% 100%;color:#fff;display:flex;font-family:SourceHanSerifCN-Regular;font-size:18px;font-weight:100;height:.348rem;left:0;padding-left:20px;position:absolute;right:0;top:0;width:100%\n}\n#client .index-container .index-right .right-container{display:flex;height:100%;padding-top:.348rem;width:100%\n}\n#client .index-container .index-right .right-container.linkman .linkman-item{align-items:center;color:#2c2c2c;cursor:pointer;display:flex;font-size:16px;height:.348rem;padding-left:.125rem;width:100%\n}\n#client .index-container .index-right .right-container.linkman .linkman-item:hover{background-color:#f3f7fb\n}\n#client .index-container .index-right .right-container.linkman .linkman-item .item-avatar{height:.209rem;margin-right:.07rem;width:.209rem\n}\n#client .index-container .index-right .right-container.conversation .index-user{background:#f1f1f1;border-right:1px solid #d9dee4;height:100%;overflow-y:auto;position:relative;width:2.153rem\n}\n#client .index-container .index-right .right-container.conversation .index-user .user-item{cursor:pointer;display:flex;padding:15px 0 10px 20px;width:100%\n}\n#client .index-container .index-right .right-container.conversation .index-user .user-item.active{background:#fff\n}\n#client .index-container .index-right .right-container.conversation .index-user .user-item .el-badge__content{border:none\n}\n#client .index-container .index-right .right-container.conversation .index-user .user-item .item-avatar{display:block;height:44px;width:44px\n}\n#client .index-container .index-right .right-container.conversation .index-user .user-item .item-info{flex:1;margin-left:10px\n}\n#client .index-container .index-right .right-container.conversation .index-user .user-item .item-info .info-header{align-items:center;display:flex;margin:2px 0 6px;width:100%\n}\n#client .index-container .index-right .right-container.conversation .index-user .user-item .item-info .info-header .info-username{font-size:16px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap\n}\n#client .index-container .index-right .right-container.conversation .index-user .user-item .item-info .info-header .info-time{color:#c8c8c8;font-size:12px;margin-left:auto;margin-right:8px\n}\n#client .index-container .index-right .right-container.conversation .index-user .user-item .item-info .info-lastMsg{align-items:center;color:#9d9d9d;display:flex;font-size:12px\n}\n#client .index-container .index-right .right-container.conversation .index-user .user-item .item-info .info-lastMsg .lastMsg-read{margin-right:4px;white-space:nowrap\n}\n#client .index-container .index-right .right-container.conversation .index-user .user-item .item-info .info-lastMsg .lastMsg-read.unread{color:#ce1b10\n}\n#client .index-container .index-right .right-container.conversation .index-user .user-item .item-info .info-lastMsg .lastMsg-content{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:170px\n}\n#client .index-container .index-right .right-container.conversation .index-user .user-item .item-info .info-content{color:#9d9d9d;font-size:12px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:170px\n}\n#client .index-container .index-right .right-container.conversation .index-conversation{flex:1;height:100%;overflow:hidden\n}\n#client .index-container .index-right .right-container.conversation .index-conversation .conversation-container{display:flex;flex-direction:column;height:100%;position:relative;width:100%\n}\n#client .index-container .index-right .right-container.conversation .index-conversation .conversation-container .conversation-main{display:flex;flex-direction:column;height:3.195rem;overflow:hidden;width:100%\n}\n#client .index-container .index-right .right-container.conversation .index-conversation .conversation-container .conversation-main .conversation-title{align-items:center;display:flex;font-size:16px;height:.278rem;overflow:hidden;padding:0 .139rem;text-overflow:ellipsis;white-space:nowrap;width:100%\n}\n#client .index-container .index-right .right-container.conversation .index-conversation .conversation-container .conversation-main .conversation-content{border-bottom:1px solid #d9dee4;height:2.917rem;overflow-X:hidden;overflow-y:auto;padding:0 .139rem;width:100%\n}\n#client .index-container .index-right .right-container.conversation .index-conversation .conversation-container .conversation-main .conversation-content .content-list{width:100%\n}\n#client .index-container .index-right .right-container.conversation .index-conversation .conversation-container .conversation-main .conversation-content .content-list .content-item-wrap:first-child .item-time{margin-top:.139rem\n}\n#client .index-container .index-right .right-container.conversation .index-conversation .conversation-container .conversation-main .conversation-content .content-list .content-item-wrap .item-time{align-items:center;display:flex;justify-content:center;margin-top:.209rem\n}\n#client .index-container .index-right .right-container.conversation .index-conversation .conversation-container .conversation-main .conversation-content .content-list .content-item-wrap .item-time .time-value{background:#f2f6fb;border-radius:5px;color:#999;font-size:12px;line-height:17px;padding:2px 9px;text-align:center\n}\n#client .index-container .index-right .right-container.conversation .index-conversation .conversation-container .conversation-main .conversation-content .content-list .content-item-wrap .item-text{display:flex;padding:.139rem 0\n}\n#client .index-container .index-right .right-container.conversation .index-conversation .conversation-container .conversation-main .conversation-content .content-list .content-item-wrap .item-text:hover .item-more .el-icon-more{visibility:visible\n}\n#client .index-container .index-right .right-container.conversation .index-conversation .conversation-container .conversation-main .conversation-content .content-list .content-item-wrap .item-text.self{justify-content:flex-end\n}\n#client .index-container .index-right .right-container.conversation .index-conversation .conversation-container .conversation-main .conversation-content .content-list .content-item-wrap .item-text.self .item-avatar{margin-left:.084rem;margin-right:0\n}\n#client .index-container .index-right .right-container.conversation .index-conversation .conversation-container .conversation-main .conversation-content .content-list .content-item-wrap .item-text.self .item-content-value{border-radius:12px 12px 2px 12px\n}\n#client .index-container .index-right .right-container.conversation .index-conversation .conversation-container .conversation-main .conversation-content .content-list .content-item-wrap .item-text.self .item-more{margin-left:0;margin-right:.084rem\n}\n#client .index-container .index-right .right-container.conversation .index-conversation .conversation-container .conversation-main .conversation-content .content-list .content-item-wrap .item-text .item-avatar{display:block;height:.278rem;margin-right:.084rem;width:.278rem\n}\n#client .index-container .index-right .right-container.conversation .index-conversation .conversation-container .conversation-main .conversation-content .content-list .content-item-wrap .item-text .item-content .item-content-value{background:#f3f3f3;border:1px solid #8e8e8e;border-radius:2px 12px 12px 12px;color:#3d3d3d;font-size:14px;line-height:20px;padding:10px 12px;word-break:break-all\n}\n#client .index-container .index-right .right-container.conversation .index-conversation .conversation-container .conversation-main .conversation-content .content-list .content-item-wrap .item-text .item-image{cursor:zoom-in\n}\n#client .index-container .index-right .right-container.conversation .index-conversation .conversation-container .conversation-main .conversation-content .content-list .content-item-wrap .item-text .item-image img{border-radius:5px;display:block;max-height:2.084rem;max-width:1.389rem\n}\n#client .index-container .index-right .right-container.conversation .index-conversation .conversation-container .conversation-main .conversation-content .content-list .content-item-wrap .item-text .item-more{align-self:flex-end;margin-left:.084rem\n}\n#client .index-container .index-right .right-container.conversation .index-conversation .conversation-container .conversation-main .conversation-content .content-list .content-item-wrap .item-text .item-more .el-icon-more{background:#ccc;border-radius:5px;color:#fff;cursor:pointer;font-size:16px;margin-bottom:5px;padding:1px 2px;text-align:center;visibility:hidden;width:100%\n}\n#client .index-container .index-right .right-container.conversation .index-conversation .conversation-container .conversation-main .conversation-content .content-list .content-item-wrap .item-text .item-more .item-read{color:#a3a3a3;display:block;font-size:12px;white-space:nowrap\n}\n#client .index-container .index-right .right-container.conversation .index-conversation .conversation-container .conversation-main .conversation-content .content-list .content-item-wrap .item-text .item-more .item-read.unread{color:#ce1b10\n}\n#client .index-container .index-right .right-container.conversation .index-conversation .conversation-container .conversation-publish{height:1.389rem;overflow:hidden\n}\n#client .index-container .index-right .right-container.conversation .index-conversation .conversation-container .conversation-publish .publish-tool{align-items:center;display:flex;height:24px;margin:8px 0 12px\n}\n#client .index-container .index-right .right-container.conversation .index-conversation .conversation-container .conversation-publish .publish-tool .tool-item{color:#888;cursor:pointer;font-size:24px;margin-left:18px\n}\n#client .index-container .index-right .right-container.conversation .index-conversation .conversation-container .conversation-publish .publish-tool .tool-item.active,#client .index-container .index-right .right-container.conversation .index-conversation .conversation-container .conversation-publish .publish-tool .tool-item:hover{color:#56c7c6\n}\n#client .index-container .index-right .right-container.conversation .index-conversation .conversation-container .conversation-publish .publish-content textarea{border:none\n}\n#client .index-container .index-right .right-container.conversation .index-conversation .conversation-container .conversation-publish .publish-button{align-items:center;background:#fff;border:1px solid #c8c8c8;border-radius:3px;bottom:.139rem;color:#2c2c2c;cursor:pointer;display:flex;font-size:14px;height:.209rem;justify-content:center;position:absolute;right:.139rem;width:.625rem\n}\n}\n@media screen and (max-width:980px){\n#client{align-items:center;display:flex;height:100vh;overflow:hidden;position:relative;width:100%\n}\n#client .index-container{height:100%;overflow:hidden;width:100%\n}\n#client .index-container .index-menu{background:#0d0d0e;bottom:0;height:55px;left:0;position:fixed;right:0;width:100%;z-index:99\n}\n#client .index-container .index-menu .menu-setting,#client .index-container .index-menu .menu-user{display:none\n}\n#client .index-container .index-menu .menu-tabs{align-items:center;display:flex;height:100%;justify-content:space-around;width:100%\n}\n#client .index-container .index-menu .menu-tabs .tabs-item{color:#fff;display:flex;flex-direction:column;font-size:24px;height:100%;justify-content:center;padding:0 18px;text-align:center\n}\n#client .index-container .index-menu .menu-tabs .tabs-item.active{background:#ce1b10\n}\n#client .index-container .index-menu .menu-tabs .tabs-item .item-label{font-size:12px;margin-top:2px;white-space:nowrap\n}\n#client .index-container .index-right{background:#000 url("+t(e("87ce"))+") no-repeat 0 0;background-size:56px auto;height:100vh;overflow:hidden;padding-top:62px\n}\n#client .index-container .index-right .index-title{display:none\n}\n#client .index-container .index-right .right-container{background:#fff;border-top-left-radius:8px;border-top-right-radius:8px;height:100%;overflow:hidden;width:100%\n}\n#client .index-container .index-right .right-container.linkman{padding:0 18px\n}\n#client .index-container .index-right .right-container.linkman .linkman-item{align-items:center;border-bottom:1px solid #eee;color:#2c2c2c;display:flex;font-size:16px;height:50px;width:100%\n}\n#client .index-container .index-right .right-container.linkman .linkman-item .item-avatar{height:30px;margin-right:10px;width:30px\n}\n}",""])},ddd3:function(n,i,e){"use strict";e.r(i);var t=function(){var n=this,i=n.$createElement,t=n._self._c||i;return t("div",{attrs:{id:"client"}},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:n.loading,expression:"loading"}],staticClass:"index-container",attrs:{"element-loading-background":"rgba(0, 0, 0, 0.5)"}},[t("div",{staticClass:"index-menu"},[t("div",{staticClass:"menu-user"},[n.userInfo.avatar?t("img",{staticClass:"user-avatar",attrs:{src:n.userInfo.avatar},on:{click:function(i){n.userDialogVisible=!0}}}):t("img",{staticClass:"user-avatar",attrs:{src:e("d523")},on:{click:function(i){n.userDialogVisible=!0}}}),t("div",{staticClass:"user-status"},[n._v("在线")])]),t("div",{staticClass:"menu-tabs"},n._l(n.tabOptions,function(i,e){return t("div",{key:e,staticClass:"tabs-item",class:{active:n.tabActive===e},on:{click:function(i){n.tabActive=e}}},[t("div",{class:[i.icon,"item-icon"]}),t("div",{staticClass:"item-label"},[n._v(n._s(i.label))])])})),n.isLogin?n._e():t("div",{staticClass:"menu-setting"},[t("div",{staticClass:"setting-icon my-icon-userSetting",on:{click:function(i){n.loginDialogVisible=!0}}})])]),t("div",{staticClass:"index-right"},[t("div",{staticClass:"index-title"},[n._v("马自达在线顾问")]),0===n.tabActive?t("div",{staticClass:"right-container linkman"},n._l(n.customList,function(i,e){return t("div",{key:e,staticClass:"linkman-item",on:{click:function(e){n.handleLinkman(i)}}},[t("img",{staticClass:"item-avatar",attrs:{src:i.avatar}}),t("div",{staticClass:"item-username"},[n._v(n._s(i.nickname||i.username))])])})):n._e(),t("div",{directives:[{name:"show",rawName:"v-show",value:1===n.tabActive,expression:"tabActive === 1"}],staticClass:"right-container conversation"},[t("my-chat",{attrs:{activeUser:n.activeUser,initData:n.initData,userInfo:n.userInfo,json:n.conversationList}})],1)])]),n.loginDialogVisible?t("login-dialog",{on:{close:function(i){n.loginDialogVisible=!1},onSubmit:n.login}}):n._e(),n.userDialogVisible?t("user-dialog",{attrs:{userInfo:n.userInfo},on:{close:function(i){n.userDialogVisible=!1}}}):n._e()],1)},o=[],r=e("c93e"),a=(e("55dd"),e("ac6a"),e("ed08")),c=e("365c"),s=e("1660"),d={name:"client",data:function(){return{initData:"",userInfo:"",tabOptions:[{icon:"my-icon-linkman",label:"联系人"},{icon:"my-icon-conversation",label:"历史会话"}],tabActive:0,customList:"",conversationList:[],initChat:!1,mergeTime_ms:18e4,userDialogVisible:!1,loginDialogVisible:!1,loading:!1,activeUser:"",isLogin:!1}},mounted:function(){this.getCustomList()},beforeRouteLeave:function(n,i,e){this.loginOut(),e()},methods:{getCustomList:function(){var n=this;Object(c["c"])().then(function(i){if(console.log("获取在线客服",i),0===i.code){var e=!1;e=i.data2.some(function(n){return n.online}),e?(n.initJIM(),n.customList=i.data.filter(function(n){return n.online})):n.$router.push({name:"message"})}})},initJIM:function(n){var i=this;this.loading=!0,Object(c["e"])().then(function(e){console.log("获取极光初始化参数：",e),i.initData=e.data,s["a"].init(i.initData).then(function(){if(n){var e={username:n.data.username,password:n.data.password};console.log("账号登录参数",e),s["a"].login(e).then(function(e){console.log("登录成功",e),i.userInfo=n,i.syncConversation()}).catch(function(n){i.$message.error("登录失败"),console.log("登录失败",n)})}else Object(c["h"])().then(function(n){console.log("游客信息",n);var e={username:n.data.username,password:n.data.password};console.log("游客登录参数",e),s["a"].login(e).then(function(e){console.log("登录成功",e),i.userInfo=n.data,i.syncConversation()}).catch(function(n){console.log("登录失败",n),880103===n.code?JimApi.register(form).then(function(){i.initJIM()}):88107===n.code?JimApi.loginOut():i.$message.error("登录失败")})});var t=i.$cache.getLocal("mazda_login");i.isLogin=!!t})})},syncConversation:function(){var n=this;this.loading=!1,s["a"].onSyncConversation().then(function(i){console.log("同步会话内容 syncConversationContent",i),s["a"].getConversation().then(function(e){console.log("同步会话列表 syncConversationList",e),n.conversationList=e.conversations,n.conversationList.forEach(function(e){i.forEach(function(i){if(i.receipt_msgs.forEach(function(e){i.msgs.some(function(i){if(e.msg_id===i.msg_id)return n.$set(i,"read",!0),!0})}),e.username===i.from_username){for(var t=i.msgs.map(function(i){return i.content.msg_body.media_id&&s["a"].getResource(i.content.msg_body.media_id).then(function(e){n.$set(i,"local_url",e)}),i}),o=t.length-1;o>0;o--)t[o].ctime_ms-t[o-1].ctime_ms<=n.mergeTime_ms&&n.$set(t[o],"ctime_ms_hide",!0);n.$set(e,"msgs",t)}})}),n.conversationList.sort(Object(a["a"])("des","mtime"))})})},handleLinkman:function(n){this.tabActive=1,this.activeUser=n,this.initChat=!0},login:function(n){var i=this;Object(c["f"])(n).then(function(n){console.log("mazda登录成功",n),i.$cache.setLocal("mazda_login",n.data.uuid),n.data.uuid!==i.userInfo.uuid?s["a"].loginOut().then(function(){console.log("已退出登录"),i.initJIM(n)}):i.userInfo=Object(r["a"])({},i.userInfo,n.data),i.loginDialogVisible=!1,i.isLogin=!0,i.$message.success("登录成功")}).catch(function(n){console.log(n),i.$message.success("账号或密码错误")})},loginOut:function(){s["a"].loginOut().then(function(){console.log("已退出登录")})}}},l=d,x=(e("a2de"),e("2877")),m=Object(x["a"])(l,t,o,!1,null,null,null);m.options.__file="client.vue";i["default"]=m.exports}}]);